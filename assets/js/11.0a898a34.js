(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{276:function(s,t,a){"use strict";a.r(t);var n=a(13),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"插件编写指南"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#插件编写指南"}},[s._v("#")]),s._v(" 插件编写指南")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("指南")]),s._v(" "),t("p",[s._v("可以参考本项目内置插件编写，也可以参考："),t("a",{attrs:{href:"https://v2.nonebot.dev/docs/tutorial/plugin/introduction",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),t("OutboundLink")],1)])]),s._v(" "),t("h2",{attrs:{id:"在plugins下创建新的插件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#在plugins下创建新的插件"}},[s._v("#")]),s._v(" 在plugins下创建新的插件")]),s._v(" "),t("p",[s._v("你的插件只需要在"),t("code",[s._v("src/plugins/")]),s._v("下创建新的文件夹即可，插件会自动导入。")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("注意插件名称")]),s._v(" "),t("p",[s._v("nb2中“_”开头的插件不会被导入，请不要创建这种插件，或者选择手动导入。")])]),s._v(" "),t("h2",{attrs:{id:"安装nb2插件商店的插件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装nb2插件商店的插件"}},[s._v("#")]),s._v(" 安装nb2插件商店的插件")]),s._v(" "),t("p",[s._v("本项目使用nonebot2框架，支持插件商店安装插件，商店地址："),t("a",{attrs:{href:"https://v2.nonebot.dev/store",target:"_blank",rel:"noopener noreferrer"}},[s._v("传送门"),t("OutboundLink")],1)]),s._v(" "),t("div",{staticClass:"custom-block danger"},[t("p",{staticClass:"custom-block-title"},[s._v("元数据")]),s._v(" "),t("p",[s._v("由于本项目的插件管理器使用额外的插件元数据配置管理，商店插件没有此项配置，这将导致：")]),s._v(" "),t("ul",[t("li",[s._v("你无法使用“菜单”命令查看到已加载的该插件")]),s._v(" "),t("li",[s._v("你无法使用“打开/关闭”命令设置该插件开关")])]),s._v(" "),t("p",[s._v("如果需要适配插件管理器，可以参考"),t("a",{attrs:{href:"#%E6%B7%BB%E5%8A%A0%E6%8F%92%E4%BB%B6%E5%85%83%E6%95%B0%E6%8D%AE"}},[s._v("#添加插件元数据")])])]),s._v(" "),t("h3",{attrs:{id:"使用pip或者nb-plugin命令安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用pip或者nb-plugin命令安装"}},[s._v("#")]),s._v(" 使用pip或者nb plugin命令安装")]),s._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),t("p",[s._v("由于项目不使用"),t("code",[s._v("pyproject.toml")]),s._v("管理插件加载，所以使用命令安装插件：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("nb plugin "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" plugin_name\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("会提示错误：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("RuntimeError"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Config file .../pyproject.toml does not exist!'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("忽略此错误，采用手动加载插件。")])]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("从bot.py加载插件")]),s._v(" "),t("p",[s._v("在bot.py的25行后加入：")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[s._v("nonebot"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("load_plugin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"商店插件名称"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])]),s._v(" "),t("h3",{attrs:{id:"使用git安装插件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用git安装插件"}},[s._v("#")]),s._v(" 使用git安装插件")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("使用git安装插件")]),s._v(" "),t("p",[s._v("可以在github将插件源码下载到本地，插件文件夹放入"),t("code",[s._v("src/plugins")]),s._v("下，这样商店插件会当作本地插件自动导入了，不需要额外添加加载插件代码。")])]),s._v(" "),t("h2",{attrs:{id:"添加插件元数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#添加插件元数据"}},[s._v("#")]),s._v(" 添加插件元数据")]),s._v(" "),t("p",[s._v("nb2在beta4中加入了插件元数据，本项目插件管理器基于此数据进行插件管理，要使用元数据，需要在插件文件夹下的"),t("code",[s._v("__init__.py")]),s._v("中加入：")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" nonebot"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("plugin "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" PluginMetadata\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" src"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("params "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" PluginConfig\n\n__plugin_meta__ "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" PluginMetadata"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"插件名称"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    description"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"插件描述"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    usage"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"使用命令"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    config"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("PluginConfig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("div",{staticClass:"custom-block danger"},[t("p",{staticClass:"custom-block-title"},[s._v("在params导入PluginConfig")]),s._v(" "),t("p",[s._v("PluginConfig是本项目自带的插件管理器所需要的配置，如果没有此设置，插件管理器将无法管理此插件。")])]),s._v(" "),t("p",[s._v("可以在"),t("code",[s._v("src/params.py")]),s._v("找到"),t("code",[s._v("PluginConfig")]),s._v("：")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PluginConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("BaseModel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    enable_managed"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bool")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v('"""\n    是否受插件管理器管理，若设置成False，插件管理器将不会管理\n    """')]),s._v("\n    default_status"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bool")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v('"""默认开关"""')]),s._v("\n    cost_gold"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v('"""\n    使用花费，这里只是显示在菜单中，真正起效在params的cost_gold()\n    """')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("里面字段都有默认设置，如果你想修改该设置，可以使用以下方法：")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[s._v("__plugin_meta__ "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" PluginMetadata"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"插件名称"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    description"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"插件描述"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    usage"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"使用命令"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    config"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("PluginConfig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("default_status"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 此插件默认开关为关闭")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("对于商店安装的插件")]),s._v(" "),t("p",[s._v("使用pip或者nb plugin安装的商店插件会保存到pip的"),t("code",[s._v("site-packages")]),s._v("目录下（对于conda，他应该保存在"),t("code",[s._v("conda/envs/evn_name/Lib/site-packages")]),s._v("下），你可以将插件复制到本地插件文件夹下将其变为本地插件，然后添加元数据；也可以直接在此文件夹下修改内容添加元数据（修改后更新插件需要同步修改）")])]),s._v(" "),t("h2",{attrs:{id:"使用金币工具"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用金币工具"}},[s._v("#")]),s._v(" 使用金币工具")]),s._v(" "),t("p",[s._v("如果你想让你的插件每次被调用都会扣掉金币，则可以参考以下方法：")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" src"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("params "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" cost_gold\n\nmatcher "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" on_xxx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 定义你的matcher")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@matcher"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("handle")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("parameterless"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("cost_gold"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("gold"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里的gold就是价格")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("async")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("_")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 你的响应器")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[s._v("修改菜单价格")]),s._v(" "),t("p",[s._v("上面的是实际需要消耗的金币，同时你应该修改菜单上显示的价格，你需要：")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[s._v("__plugin_meta__ "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" PluginMetadata"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"插件名称"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    description"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"插件说明"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    usage"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"指令"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    config"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("PluginConfig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cost_gold"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里在菜单显示")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])])])])}),[],!1,null,null,null);t.default=e.exports}}]);